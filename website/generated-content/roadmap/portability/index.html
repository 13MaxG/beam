<!DOCTYPE html>
<!--
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at
   http://www.apache.org/licenses/LICENSE-2.0
 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License. See accompanying LICENSE file.
-->

<html lang="en">
  <!--
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at
   http://www.apache.org/licenses/LICENSE-2.0
 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License. See accompanying LICENSE file.
-->

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Portability Framework Roadmap</title>
  <meta name="description" content="Apache Beam is an open source, unified model and set of language-specific SDKs for defining and executing data processing workflows, and also data ingestion and integration flows, supporting Enterprise Integration Patterns (EIPs) and Domain Specific Languages (DSLs). Dataflow pipelines simplify the mechanics of large-scale batch and streaming data processing and can run on a number of runtimes like Apache Flink, Apache Spark, and Google Cloud Dataflow (a cloud service). Beam also brings DSL in different languages, allowing users to easily implement their data integration processes.
">
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400" rel="stylesheet">
  <link rel="stylesheet" href="/css/site.css">
  <script src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
  <style>
    .body__contained img { max-width: 100% }
  </style>
  <script src="/js/bootstrap.min.js"></script>
  <script src="/js/language-switch.js"></script>
  <script src="/js/fix-menu.js"></script>
  <script src="/js/section-nav.js"></script>
  <script src="/js/page-nav.js"></script>
  <link rel="canonical" href="https://beam.apache.org/roadmap/portability/" data-proofer-ignore>
  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico">
  <link rel="alternate" type="application/rss+xml" title="Apache Beam" href="https://beam.apache.org/feed.xml">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous">
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-73650088-1', 'auto');
    ga('send', 'pageview');
  </script>
</head>

  <body class="body" data-spy="scroll" data-target=".page-nav" data-offset="0">
    <!--
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at
   http://www.apache.org/licenses/LICENSE-2.0
 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License. See accompanying LICENSE file.
-->

<nav class="header navbar navbar-fixed-top">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <a href="/" class="navbar-brand" >
        <img alt="Brand" style="height: 25px" src="/images/beam_logo_navbar.png">
      </a>
    </div>

    <div class="navbar-mask closed"></div>

    <div id="navbar" class="navbar-container closed">
      <ul class="nav navbar-nav">
        <li>
          <a href="/get-started/beam-overview/">Get Started</a>
        </li>
        <li>
          <a href="/documentation/">Documentation</a>
        </li>
        <li>
          <a href="/documentation/sdks/java/">Languages</a>
        </li>
        <li>
          <a href="/documentation/runners/capability-matrix/">RUNNERS</a>
        </li>
        <li>
          <a href="/roadmap/">Roadmap</a>
        </li>
        <li>
          <a href="/contribute/">Contribute</a>
        </li>
        <li>
          <a href="/community/contact-us/">Community</a>
        </li>
        <li><a href="/blog">Blog</a></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
          <div style="width: 300px;">
            <script>
              (function() {
                var cx = '012923275103528129024:4emlchv9wzi';
                var gcse = document.createElement('script');
                gcse.type = 'text/javascript';
                gcse.async = true;
                gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(gcse, s);
              })();
            </script>
            <gcse:search></gcse:search>
          </div>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false"><img src="https://www.apache.org/foundation/press/kit/feather_small.png" alt="Apache Logo" style="height:20px;"><span class="caret"></span></a>
          <ul class="dropdown-menu dropdown-menu-right">
            <li><a href="http://www.apache.org/">ASF Homepage</a></li>
            <li><a href="http://www.apache.org/licenses/">License</a></li>
            <li><a href="http://www.apache.org/security/">Security</a></li>
            <li><a href="http://www.apache.org/foundation/thanks.html">Thanks</a></li>
            <li><a href="http://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
            <li><a href="https://www.apache.org/foundation/policies/conduct">Code of Conduct</a></li>
          </ul>
        </li>
        <li>
          <!--
            data-proofer-ignore disables link checking from website test automation.
            GitHub links will not resolve until the markdown source is available on the master branch.
            New pages would fail validation during development / PR test automation.
          -->
          <a href="https://github.com/apache/beam/edit/master/website/src/roadmap/portability.md" data-proofer-ignore>
            <i class="far fa-edit fa-lg" alt="Edit on GitHub" title="Edit on GitHub"></i>
          </a>
        </li>
      </ul>
    </div>
</nav>

    <div class="clearfix container-main-content">
      <div class="section-nav closed" data-offset-top="90" data-offset-bottom="500">
        <span class="section-nav-back glyphicon glyphicon-menu-left"></span>
        <nav>
          <ul class="section-nav-list" data-section-nav>
            <!--
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at
   http://www.apache.org/licenses/LICENSE-2.0
 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License. See accompanying LICENSE file.
-->

<li><span class="section-nav-list-main-title">Roadmap</span></li>
<li><a href="/roadmap/">Roadmap Highlights</a></li>
<li><a href="/roadmap/portability">Portability Framework</a></li>
<li class="section-nav-item">
  <span class="section-nav-list-title">Languages</span>

  <ul class="section-nav-list">
    <li><a href="/roadmap/java-sdk">Java SDK</a></li>
    <li><a href="/roadmap/go-sdk">Go SDK</a></li>
    <li><a href="/roadmap/python-sdk">Python SDK</a></li>
    <li><a href="/roadmap/euphoria">Euphoria API</a></li>
    <li><a href="/roadmap/sql">SQL</a></li>
  </ul>
</li>
<li class="section-nav-item">
  <span class="section-nav-list-title">Runners</span>

  <ul class="section-nav-list">
    <li><a href="/roadmap/apex-runner/">Apex Runner</a></li>
    <li><a href="/roadmap/dataflow-runner/">Google Cloud Dataflow Runner</a></li>
    <li><a href="/roadmap/flink-runner/">Flink Runner</a></li>
    <li><a href="/roadmap/gearpump-runner/">Gearpump Runner</a></li>
    <li><a href="/roadmap/nemo-runner/">Nemo Runner</a></li>
    <li><a href="/roadmap/spark-runner/">Spark Runner</a></li>
    <li><a href="/roadmap/samza-runner/">Samza Runner</a></li>
  </ul>
</li>
<li class="section-nav-item">
  <span class="section-nav-list-title">Connectors</span>

  <ul class="section-nav-list">
    <li><a href="/roadmap/connectors-java-sdk/">Java SDK</a></li>
    <li><a href="/roadmap/connectors-python-sdk/">Python SDK</a></li>
    <li><a href="/roadmap/connectors-go-sdk/">Go SDK</a></li>
    <li><a href="/roadmap/connectors-multi-sdk/">Multi-SDK Efforts</a></li>
  </ul>
</li>

          </ul>
        </nav>
      </div>

      <nav class="page-nav clearfix" data-offset-top="90" data-offset-bottom="500">
        <!--
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at
   http://www.apache.org/licenses/LICENSE-2.0
 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License. See accompanying LICENSE file.
-->



<ul class="nav">
  <li><a href="#overview">Overview</a></li>
  <li><a href="#milestones">Milestones</a></li>
  <li><a href="#issues">Issues</a></li>
  <li><a href="#status">Status</a>
    <ul>
      <li><a href="#python-on-flink">Running Python wordcount on Flink</a></li>
      <li><a href="#python-on-spark">Running Python wordcount on Spark</a></li>
    </ul>
  </li>
  <li><a href="#sdk-harness-config">SDK Harness Configuration</a></li>
</ul>


      </nav>

      <div class="body__contained body__section-nav">
        <!--
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<h1 id="portability-framework-roadmap">Portability Framework Roadmap</h1>

<h2 id="overview">Overview</h2>

<p>Interoperability between SDKs and runners is a key aspect of Apache
Beam. So far, however, the reality is that most runners support the
Java SDK only, because each SDK-runner combination requires non-trivial
work on both sides. All runners are also currently written in Java,
which makes support of non-Java SDKs far more expensive. The
<em>portability framework</em> aims to rectify this situation and provide
full interoperability across the Beam ecosystem.</p>

<p>The portability framework introduces well-defined, language-neutral
data structures and protocols between the SDK and runner. This interop
layer – called the <em>portability API</em> – ensures that SDKs and runners
can work with each other uniformly, reducing the interoperability
burden for both SDKs and runners to a constant effort.  It notably
ensures that <em>new</em> SDKs automatically work with existing runners and
vice versa.  The framework introduces a new runner, the <em>Universal
Local Runner (ULR)</em>, as a practical reference implementation that
complements the direct runners. Finally, it enables cross-language
pipelines (sharing I/O or transformations across SDKs) and
user-customized execution environments (“custom containers”).</p>

<p>The portability API consists of a set of smaller contracts that
isolate SDKs and runners for job submission, management and
execution. These contracts use protobufs and <a href="https://grpc.io">gRPC</a> for broad language
support.</p>

<ul>
  <li>
    <p><strong>Job submission and management</strong>: The <em>Runner API</em> defines a
language-neutral pipeline representation with transformations
specifying the execution environment as a docker container
image. The latter both allows the execution side to set up the
right environment as well as opens the door for custom containers
and cross-environment pipelines. The <em>Job API</em> allows pipeline
execution and configuration to be managed uniformly.</p>
  </li>
  <li>
    <p><strong>Job execution</strong>: The <em>SDK harness</em> is a SDK-provided
program responsible for executing user code and is run separately
from the runner.  The <em>Fn API</em> defines an execution-time binary
contract between the SDK harness and the runner that describes how
execution tasks are managed and how data is transferred. In
addition, the runner needs to handle progress and monitoring in an
efficient and language-neutral way. SDK harness initialization
relies on the <em>Provision</em> and <em>Artifact APIs</em> for obtaining staged
files, pipeline options and environment information. Docker
provides isolation between the runner and SDK/user environments to
the benefit of both as defined by the <em>container contract</em>. The
containerization of the SDK gives it (and the user, unless the SDK
is closed) full control over its own environment without risk of
dependency conflicts. The runner has significant freedom regarding
how it manages the SDK harness containers.</p>
  </li>
</ul>

<p>The goal is that all (non-direct) runners and SDKs eventually support
the portability API, perhaps exclusively.</p>

<p>If you are interested in digging in to the designs, you can find
them on the <a href="https://cwiki.apache.org/confluence/display/BEAM/Apache+Beam">Beam developers’ wiki</a>.</p>

<h2 id="milestones">Milestones</h2>

<p>The portability framework is a substantial effort that touches every
Beam component. In addition to the sheer magnitude, a major challenge
is engineering an interop layer that does not significantly compromise
performance due to the additional serialization overhead of a
language-neutral protocol.</p>

<p>The proposed project phases are roughly as follows and are not
strictly sequential, as various components will likely move at
different speeds. Additionally, there have been (and continues to be)
supporting refactorings that are not always tracked as part of the
portability effort. Work already done is not tracked here either.</p>

<ul>
  <li>
    <p><strong>P1 [MVP]</strong>: Implement the fundamental plumbing for portable SDKs
and runners for batch and streaming, including containers and the
ULR
[<a href="https://issues.apache.org/jira/browse/BEAM-2899">BEAM-2899</a>]. Each
SDK and runner should use the portability framework at least to the
extent that wordcount
[<a href="https://issues.apache.org/jira/browse/BEAM-2896">BEAM-2896</a>] and
windowed wordcount
[<a href="https://issues.apache.org/jira/browse/BEAM-2941">BEAM-2941</a>] run
portably.</p>
  </li>
  <li>
    <p><strong>P2 [Feature complete]</strong>: Design and implement portability support
for remaining execution-side features, so that any pipeline from
any SDK can run portably on any runner. These features include side
inputs
[<a href="https://issues.apache.org/jira/browse/BEAM-2863">BEAM-2863</a>], User state [<a href="https://issues.apache.org/jira/browse/BEAM-2862">BEAM-2862</a>], User
timers
[<a href="https://issues.apache.org/jira/browse/BEAM-2925">BEAM-2925</a>],
Splittable DoFn
[<a href="https://issues.apache.org/jira/browse/BEAM-2896">BEAM-2896</a>] and
more.  Each SDK and runner should use the portability framework at
least to the extent that the mobile gaming examples
[<a href="https://issues.apache.org/jira/browse/BEAM-2940">BEAM-2940</a>] run
portably.</p>
  </li>
  <li>
    <p><strong>P3 [Performance]</strong>: Measure and tune performance of portable
pipelines using benchmarks such as Nexmark. Features such as
progress reporting
[<a href="https://issues.apache.org/jira/browse/BEAM-2940">BEAM-2940</a>],
combiner lifting
[<a href="https://issues.apache.org/jira/browse/BEAM-2937">BEAM-2937</a>] and
fusion are expected to be needed.</p>
  </li>
  <li>
    <p><strong>P4 [Cross language]</strong>: Design and implement cross-language
pipeline support, including how the ecosystem of shared transforms
should work.</p>
  </li>
</ul>

<h2 id="issues">Issues</h2>

<p>The portability effort touches every component, so the “portability”
label is used to identify all portability-related issues. Pure
design or proto definitions should use the “beam-model” component. A
common pattern for new portability features is that the overall
feature is in “beam-model” with subtasks for each SDK and runner in
their respective components.</p>

<p><strong>JIRA:</strong> <a href="https://issues.apache.org/jira/issues/?jql=project %3D BEAM AND resolution %3D Unresolved AND labels %3D portability order by priority DESC%2Cupdated DESC">query</a></p>

<h2 id="status">Status</h2>

<p>MVP, and FeatureCompletness nearly done (missing SDF, timers) for
SDKs, Python ULR, and shared java runners library.
Currently, the Flink and Spark runners support portable pipeline execution.
See the
<a href="https://s.apache.org/apache-beam-portability-support-table">Portability support table</a>
for details.</p>

<p>Prerequisites: <a href="https://docs.docker.com/compose/install/">Docker</a>, <a href="https://docs.python-guide.org/starting/install3/linux/">Python</a>, <a href="https://openjdk.java.net/install/">Java 8</a></p>

<h3 id="python-on-flink">Running Python wordcount on Flink</h3>

<p>The Beam Flink runner can run Python pipelines in batch and streaming modes.
Please see the <a href="/documentation/runners/flink/">Flink Runner page</a> for more information on
how to run portable pipelines on top of Flink.</p>

<h3 id="python-on-spark">Running Python wordcount on Spark</h3>

<p>The Beam Spark runner can run Python pipelines in batch mode.
Please see the <a href="/documentation/runners/spark/">Spark Runner page</a> for more information on
how to run portable pipelines on top of Spark.</p>

<p>Python streaming mode is not yet supported on Spark.</p>

<h2 id="sdk-harness-config">SDK Harness Configuration</h2>

<p>The Beam Python SDK allows configuration of the SDK harness to accommodate varying cluster setups.</p>

<ul>
  <li><code class="highlighter-rouge">environment_type</code> determines where user code will be executed.
    <ul>
      <li><code class="highlighter-rouge">LOOPBACK</code>: User code is executed within the same process that submitted the pipeline. This
option is useful for local testing. However, it is not suitable for a production environment,
as it requires a connection between the original Python process and the worker nodes, and
performs work on the machine the job originated from, not the worker nodes.</li>
      <li><code class="highlighter-rouge">PROCESS</code>: User code is executed by processes that are automatically started by the runner on
each worker node.</li>
      <li><code class="highlighter-rouge">DOCKER</code> (default): User code is executed within a container started on each worker node.
This requires docker to be installed on worker nodes. For more information, see
<a href="/documentation/runtime/environments/">here</a>.</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">environment_config</code> configures the environment depending on the value of <code class="highlighter-rouge">environment_type</code>.
    <ul>
      <li>When <code class="highlighter-rouge">environment_type=DOCKER</code>: URL for the Docker container image.</li>
      <li>When <code class="highlighter-rouge">environment_type=PROCESS</code>: JSON of the form <code class="highlighter-rouge"><span class="p">{</span><span class="nt">"os"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;OS&gt;"</span><span class="p">,</span><span class="w"> </span><span class="nt">"arch"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;ARCHITECTURE&gt;"</span><span class="p">,</span><span class="w">
</span><span class="nt">"command"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;process to execute&gt;"</span><span class="p">,</span><span class="w"> </span><span class="nt">"env"</span><span class="p">:{</span><span class="nt">"&lt;Environment variables 1&gt;"</span><span class="p">:</span><span class="w"> </span><span class="s2">"&lt;ENV_VAL&gt;"</span><span class="p">}</span><span class="w"> </span><span class="p">}</span></code>. All
fields in the JSON are optional except <code class="highlighter-rouge">command</code>.</li>
    </ul>
  </li>
  <li><code class="highlighter-rouge">sdk_worker_parallelism</code> sets the number of SDK workers that will run on each worker node.</li>
</ul>

      </div>
    </div>
    <!--
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at
   http://www.apache.org/licenses/LICENSE-2.0
 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License. See accompanying LICENSE file.
-->

<footer class="footer">
  <div class="footer__contained">
    <div class="footer__cols">
      <div class="footer__cols__col">
        <div class="footer__cols__col__logo">
          <img src="/images/beam_logo_circle.svg" class="footer__logo" alt="Beam logo">
        </div>
        <div class="footer__cols__col__logo">
          <img src="/images/apache_logo_circle.svg" class="footer__logo" alt="Apache logo">
        </div>
      </div>
      <div class="footer__cols__col footer__cols__col--md">
        <div class="footer__cols__col__title">Start</div>
        <div class="footer__cols__col__link"><a href="/get-started/beam-overview/">Overview</a></div>
        <div class="footer__cols__col__link"><a href="/get-started/quickstart-java/">Quickstart (Java)</a></div>
        <div class="footer__cols__col__link"><a href="/get-started/quickstart-py/">Quickstart (Python)</a></div>
        <div class="footer__cols__col__link"><a href="/get-started/quickstart-go/">Quickstart (Go)</a></div>
        <div class="footer__cols__col__link"><a href="/get-started/downloads/">Downloads</a></div>
      </div>
      <div class="footer__cols__col footer__cols__col--md">
        <div class="footer__cols__col__title">Docs</div>
        <div class="footer__cols__col__link"><a href="/documentation/programming-guide/">Concepts</a></div>
        <div class="footer__cols__col__link"><a href="/documentation/pipelines/design-your-pipeline/">Pipelines</a></div>
        <div class="footer__cols__col__link"><a href="/documentation/runners/capability-matrix/">Runners</a></div>
      </div>
      <div class="footer__cols__col footer__cols__col--md">
        <div class="footer__cols__col__title">Community</div>
        <div class="footer__cols__col__link"><a href="/contribute/">Contribute</a></div>
        <div class="footer__cols__col__link"><a href="https://projects.apache.org/committee.html?beam" target="_blank">Team<img src="/images/external-link-icon.png"
                                                                                                                                width="14" height="14"
                                                                                                                                alt="External link."></a></div>
        <div class="footer__cols__col__link"><a href="/contribute/presentation-materials/">Media</a></div>
      </div>
      <div class="footer__cols__col footer__cols__col--md">
        <div class="footer__cols__col__title">Resources</div>
        <div class="footer__cols__col__link"><a href="/blog/">Blog</a></div>
        <div class="footer__cols__col__link"><a href="/get-started/support/">Support</a></div>
        <div class="footer__cols__col__link"><a href="https://github.com/apache/beam">GitHub</a></div>
      </div>
    </div>
  </div>
  <div class="footer__bottom">
    &copy;
    <a href="http://www.apache.org">The Apache Software Foundation</a>
    | <a href="/privacy_policy">Privacy Policy</a>
    | <a href="/feed.xml">RSS Feed</a>
    <br><br>
    Apache Beam, Apache, Beam, the Beam logo, and the Apache feather logo are
    either registered trademarks or trademarks of The Apache Software
    Foundation. All other products or name brands are trademarks of their
    respective holders, including The Apache Software Foundation.
  </div>
</footer>

  </body>
</html>
